properties([pipelineTriggers([githubPush()])])
 
pipeline {
   agent any
   stages {
      stage('Checkout SCM') {
         agent none
         steps {
            echo "working..."
            checkout([
             $class: 'GitSCM',
             branches: [[name: 'master']],
             userRemoteConfigs: [[
                url: 'https://github.com/richasingh17/springboot-sampleapp.git',
                credentialsId: 'f28c38a6-c27b-4dfe-b7c5-300f532afa93',
             ]]
            ])
         }
      }
      stage('Clone') {
         agent none
         steps {
            dir("/var/lib/jenkins/"){
            git 'https://github.com/richasingh17/springboot-sampleapp.git'
         }
         }
      }
      stage('Build') {
         agent none
         steps {
            dir("/var/lib/jenkins/springboot-sampleapp"){
            sh 'ls'
            sh 'mvnw package'
            }
         }
      }
      stage('Deploy') {
          steps {
              dir("/var/lib/jenkins/springboot-sampleapp/target"){
              sh 'cp -r spring-petclinic*.jar /mvn/artefact'
          }
          }
      }
   }
}
